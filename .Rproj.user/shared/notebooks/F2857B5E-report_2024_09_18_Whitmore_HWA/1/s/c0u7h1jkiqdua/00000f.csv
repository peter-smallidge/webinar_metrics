"0","#Create a Summary Data for the Speaker"
"0",""
"0",""
"0","summ_partic <- input_zoom %>% "
"0","    select(attended, state, duration, perspective, acres) %>% "
"0","    filter(attended == ""Yes"") %>% "
"0","    summarize("
"0","        Registered = n(),"
"0","        Participants_gtr20min = sum(attended == ""Yes"" & duration > 19, na.rm = TRUE),"
"0","        Total_Acres_gtr20min = sum(acres[attended == ""Yes"" & duration > 19], na.rm = TRUE),"
"0","        # Sum of acres where attended == ""Yes"" and duration > 19"
"0","        States_Provinces = n_distinct(state),"
"0","    ) %>% "
"0","    mutate("
"0","        Total_Acres_gtr20min = scales::comma(Total_Acres_gtr20min),"
"0","        Registered = as.character(Registered),"
"0","        Participants_gtr20min = as.character(Participants_gtr20min),"
"0","        States_Provinces = as.character(States_Provinces)"
"0","    ) %>% "
"0","    pivot_longer(c(Registered, Participants_gtr20min, Total_Acres_gtr20min, States_Provinces), names_to = ""Metric"", values_to = ""Impact"") %>% "
"0","    mutate("
"0","        sequence = c(""A"", ""B"", ""D"", ""P"")"
"0","    )"
"0","    "
"0","    "
"0","#this data frame ensures all levels of perspective are included for consistent reporting of rows into the table"
"0","missing_perspectives <- data.frame("
"0","  perspective = c(""Grazier"", ""Forester"", ""Woodland Owner"", ""Agency or Institution"","
"0","                  ""Logger/Forest Practitioner"", ""NGO"", ""Natural Resources Specialist"","
"0","                  ""Other"", ""Maple Producer"", ""Educator""),  # Add your missing perspective values here"
"0","  count_attended = 0,"
"0","  pct_perspective = 0"
"0",")"
"0",""
"0","summ_perspective1 <- input_zoom %>% "
"0","  filter(attended == ""Yes"") %>%  # Filter to only attended == ""Yes"""
"0","  group_by(perspective) %>%  # Group by perspective"
"0","  summarize("
"0","    count_attended = n(),  # Count the number of rows for each perspective"
"0","    pct_perspective = (count_attended / nrow(filter(input_zoom, attended == ""Yes""))) * 100  "
"0","    # Calculate percentage for each group_by"
"0","  ) %>% "
"0","  mutate_if(is.numeric, round, 0) %>% "
"0","  arrange(perspective)  # Sort by perspective alphabetically"
"0",""
"0","summ_perspective2 <- bind_rows(summ_perspective1, missing_perspectives) %>% "
"0","    group_by(perspective) %>% "
"0","    summarize("
"0","        Perspective_pct = sum(pct_perspective)"
"0","    ) %>% "
"0","    rename("
"0","            Metric = perspective,"
"0","            Impact = Perspective_pct"
"0","        ) %>% "
"0","    mutate("
"0","        Impact = as.character(Impact)"
"0","    ) %>% "
"0","    mutate("
"0","        sequence = c(""F"", ""G"", ""H"", ""I"", ""J"", ""K"", ""L"", ""M"", ""N"", ""O"")"
"0","    )"
"0",""
"0","    "
"0",""
"0","summ_ceu <- CEU_1 %>% "
"0","    summarize("
"0","        CEU_requested = n()"
"0","    ) %>% "
"0","    pivot_longer(c(CEU_requested), names_to = ""Metric"", values_to = ""Impact"") %>% "
"0","    mutate("
"0","        Impact = as.character(Impact)"
"0","    ) %>% "
"0","    mutate("
"0","        sequence = c(""W"")"
"0","    )"
"0","    "
"0",""
"0",""
"0","exit_metrics <- input_qualtrics %>%"
"0","    select(perspective, acres, awareness, knowledge, action, general_comment, miles, dollars) %>% "
"0","    summarize("
"0","        Survey_respondents = n(),"
"0","        acres_qualtrics = sum(acres, na.rm = TRUE),"
"0","        Miles_equivalent = sum(miles, na.rm = TRUE),"
"0","        Action_intended_count = sum(!is.na(action)),"
"0","        Action_pct = (Action_intended_count / Survey_respondents) * 100,"
"0","        Financial_impact = sum(dollars, na.rm = TRUE),"
"0","        Awareness_pct = sum(awareness %in% c(""high"", ""mod_high"", ""moderate"")) / sum(awareness %in% c(""high"", ""mod_high"", ""moderate"", ""min_mod"", ""minimal"")) * 100,"
"0","        Knowledge_pct = sum(knowledge %in% c(""high"", ""mod_high"", ""moderate"")) / sum(awareness %in% c(""high"", ""mod_high"", ""moderate"", ""min_mod"", ""minimal"")) * 100"
"0","    ) %>% "
"0","    mutate_if(is.numeric, round, 0) %>% "
"0","    mutate("
"0","        acres_qualtrics = scales::comma(acres_qualtrics),"
"0","        Miles_equivalent = scales::comma(Miles_equivalent),"
"0","        Financial_impact = scales::dollar(Financial_impact)"
"0","    ) %>% "
"0","    mutate("
"0","        Survey_respondents = as.character(Survey_respondents),"
"0","        Action_intended_count = as.character(Action_intended_count),"
"0","        Action_pct = as.character(Action_pct),"
"0","        Awareness_pct = as.character(Awareness_pct),"
"0","        Knowledge_pct = as.character(Knowledge_pct)"
"0","    ) %>% "
"0","    pivot_longer(c(Survey_respondents, acres_qualtrics, Miles_equivalent, Action_intended_count, Action_pct,"
"0","                   Financial_impact, Awareness_pct, Knowledge_pct),"
"0","                 names_to = ""Metric"", values_to = ""Impact"") %>% "
"0","    mutate("
"0","        sequence = c(""C"", ""E"", ""U"", ""Q"", ""R"", ""V"", ""S"", ""T"")"
"0","    )"
